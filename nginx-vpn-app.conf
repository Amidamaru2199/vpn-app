# Дополнение к существующей конфигурации nginx для app.adron-soft.ru
# 
# ВАЖНО: Этот блок нужно добавить В СУЩЕСТВУЮЩИЙ server блок для app.adron-soft.ru
# НЕ создавай новый server блок, а дополни имеющийся!

# Добавь эти location блоки в существующий server { } для app.adron-soft.ru:

    # Конфигурация для VPN App по пути /vpn-app
    # location /vpn-app/ {
    #     alias /var/www/vpn-app/dist/;
    #     try_files $uri $uri/ /vpn-app/index.html;
    location /vpn-app {
        alias /var/www/vpn-app/dist;
        try_files $uri $uri/ /vpn-app/index.html;
        
        # Заголовки для PWA
        location ~* /vpn-app/manifest\.webmanifest$ {
            add_header Content-Type application/manifest+json;
            expires 1d;
        }
        
        # Service Worker
        location ~* /vpn-app/sw\.js$ {
            add_header Content-Type application/javascript;
            add_header Cache-Control "no-cache, no-store, must-revalidate";
            add_header Pragma "no-cache";
            add_header Expires "0";
        }
        
        # Статические файлы с кешированием
        location ~* /vpn-app/.*\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }
        
        # Заголовки безопасности
        add_header X-Frame-Options "SAMEORIGIN";
        add_header X-Content-Type-Options "nosniff";
        add_header X-XSS-Protection "1; mode=block";
    }

# Дополнительные настройки сжатия (добавь в server блок если их нет):
    # gzip on;
    # gzip_vary on;
    # gzip_min_length 1024;
    # gzip_types
    #     text/plain
    #     text/css
    #     text/xml
    #     text/javascript
    #     application/javascript
    #     application/xml+rss
    #     application/json
    #     application/manifest+json;
